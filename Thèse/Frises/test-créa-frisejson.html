<!doctype html>
<html lang="fr">
<head>
  <meta charset="utf-8" />
  <title>Timeline – Une slide</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />

  <!-- Styles Knight Lab (facultatif mais recommandé) -->
  <link rel="stylesheet"
        href="https://cdn.knightlab.com/libs/timeline3/latest/css/timeline.css" />

  <!-- Librairie Knight Lab Timeline -->
  <script src="https://cdn.knightlab.com/libs/timeline3/latest/js/timeline.js"></script>

<style>
  html, body { height: 100%; margin: 0; }
  #timeline-embed { height: 90vh; }
  
/* Couleur pour les libellés des groupes (gauche) */
.tl-timenav-group:nth-child(1) .tl-timenav-group-label {
  color: #0B3C5D; /* Idée */
}
.tl-timenav-group:nth-child(2) .tl-timenav-group-label {
  color: #6B2C91; /* Terrain */
}
.tl-timenav-group:nth-child(3) .tl-timenav-group-label {
  color: #9A3412; /* Encadrement */
}
.tl-timenav-group:nth-child(4) .tl-timenav-group-label {
  color: #1F6F50; /* Écriture */
}
.tl-timenav-group:nth-child(5) .tl-timenav-group-label {
  color: #14532D; /* Outils/Infra */
}
.tl-timenav-group:nth-child(6) .tl-timenav-group-label {
  color: #FF6600; /* Publics/Événements */
}

  /* Pastilles de groupe */
  .grp-idee::before,
  .grp-terrain::before,
  .grp-encadrement::before,
  .grp-ecriture::before,
  .grp-outils::before,
  .grp-publics::before {
    content:"";
    display:inline-block;
    width:10px; height:10px;
    margin-right:6px;
    border-radius:50%;
    vertical-align: middle;
  }

  /* Couleurs sobres (bon contraste) */
  .grp-idee::before        { background:#1E88E5; }
  .grp-terrain::before     { background:#2E7D32; }
  .grp-encadrement::before { background:#EF6C00; }
  .grp-ecriture::before    { background:#6A1B9A; }
  .grp-outils::before      { background:#5E35B1; }
  .grp-publics::before     { background:#D84315; }

  /* (Optionnel) Améliorer lisibilité du panneau texte */
  .tl-storyslider .tl-slide .tl-text .tl-text-content {
    background: rgba(255,255,255,0.94);
    color: #111;
    padding: 1rem 1.25rem;
    border-radius: 12px;
    box-shadow: 0 4px 16px rgba(0,0,0,.08);
  }
  .tl-text-content h2.tl-headline { color: #0f0f0f; }

  /* Rendre les labels 100% opaques pour bien voir les couleurs */
.tl-timenav .tl-timenav-group-label { opacity: 1 !important; }

/* Optionnel : un peu plus de lisibilité */
.tl-timenav .tl-timenav-group-label {
  font-weight: 700;
  letter-spacing: .2px;
}

</style>

</head>
<body>
  <!-- L'id doit correspondre à celui utilisé dans TL.Timeline(...) -->
  <div id="timeline-embed"></div>

  <script>
    // URL vers votre fichier JSON (ici, au même niveau que cette page)
    const timelineDataUrl = "data.json";

    // Options utiles : langue FR, ancre dans l’URL, et ouverture sur une diapo donnée
    const options = {
      language: "fr",
      hash_bookmark: true,      // permet #event-... dans l’URL
      start_at_slide: 0,        // index de la slide (0 = première). Modifiez selon besoin.
      // start_at_end: true,    // alternative : démarrer à la fin
      // timenav_position: "bottom", // options possibles: top | bottom
    };

    // Initialisation
    const timeline = new TL.Timeline("timeline-embed", timelineDataUrl, options);

    // (Optionnel) Aller à une slide par ID après chargement
    // timeline.on('loaded', () => {
    //   timeline.goToId('mon-id-de-slide'); // si vos items ont un "unique_id" dans data.json
    // });

   
  // mapping nom de groupe → couleur
  const GROUP_COLORS = {
    "idée": "#0B3C5D",
    "idee": "#0B3C5D",           // fallback sans accent
    "terrain": "#6B2C91",
    "encadrement": "#9A3412",
    "écriture": "#1F6F50",
    "ecriture": "#1F6F50",
    "outils/infra": "#14532D",
    "publics/événements": "#FF6600",
    "publics/evenements": "#FF6600"
  };

  function colorGroupLabels() {
    // On cible tous les éléments "label de groupe" possibles
    const candidates = document.querySelectorAll(
      '.tl-timenav [class*="group-label"], .tl-timenav [class*="group"] [class*="label"]'
    );
    candidates.forEach(el => {
      const key = el.textContent.trim().toLowerCase();
      if (GROUP_COLORS[key]) {
        el.style.color = GROUP_COLORS[key];
        el.style.fontWeight = "700";
        el.style.opacity = "1";           // remonte l’opacité
      }
    });
  }

  // Coloration initiale quand la timeline est chargée
  timeline.on('loaded', () => {
    colorGroupLabels();

    // Recolorer si la timenav se re-rend (navigation, resize…)
    const nav = document.querySelector('.tl-timenav') || document.body;
    const obs = new MutationObserver(() => colorGroupLabels());
    obs.observe(nav, { childList: true, subtree: true });
  });


  </script>
</body>
</html>

